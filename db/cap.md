随着互联网的发展，单数据库单系统时代已经不能应对庞大的数据量，业务被拆分成多个模块，每个模块都有自己的数据库，而模块与模块之间的互相调用，也产生了一系列的问题。以下是关于分布式系统中的分布式事务问题相关内容。

分布式事务：一次大的操作分为不同的小操作由不同的分布式系统完成，针对这一个操作，其执行结果是要么全部的小操作都执行完成，要么全部回滚到最初状态，这就是分布式事务。本质就是保证不同数据库上的数据一致性。

在本地数据库上的操作我们能保证 ACID 的特性，但是在分布式系统中却存在问题。

### cap、base 理论

 **cap理论** 

在一个分布式系统（指互相连接并共享数据的节点的集合）中，当涉及读写操作时，只能保证一致性（Consistence）、可用性（Availability）、分区容错性（Partition Tolerance）三者中的两个，另外一个必须被牺牲。

一致性(C): 一致性指数据在多个副本之间能够保持一致性的特性。比如当某个数据被写入某个节点后，那么所有的节点获取该值时应该时最新的，而且是一致的。这里是强一致性，一旦写入则所有节点都查询到一致的数据。

可用性(A): 这里是指高可用性，即系统提供的服务必须一直处于可用的状态，也就是读、写永远都能成功，即服务一直可用

分区容错性(P): 容错性,那就是网络节点之间无法通信的情况下，节点被隔离，产生了网络分区， 整个系统仍然是可以工作的。

然而在分布式的环境下，网络无法做到100%可靠，所以分区容错性是前提，然而在选择了分区容错性的前提下，一致性和可用性只能二选一，不能同时保证；

假如系统之间产生了隔离，要保证整个系统仍然可用，假设有A、B、C三个节点，之间产生了隔离

假设这个时候保证一致性，这个时候如果A节点有数据写入，要保证ABC所有的节点该数据都一致，那么就不能保证可用性，因为要等到这个数据同步到其他节点保证强一致性，必须要等到ABC节点之间的网络隔离修复之后才能执行下去，这样的话，这个写入请求会一致不成功（即不能继续提供服务），直到网络恢复之后。

假设选择了可用性，即使有数据写入服务仍然可用，那么就不能保证强一致性，比如A节点有数据写入，为了保证可用性，那么这次请求可以成功，但是ABC之间使隔离的，那么它们之间的数据就不可能是一致的，所以一致性就无法保证了。

总结CAP定理中，再保证分区容错性(P)的前提下，要么选择一致性(C)，要么选择可用性(A)，即CP或AP。


### 分布式事务解决方案等

参考:[分布式基础之CAP和BASE理论](https://www.jianshu.com/p/46b90dfc7c90)
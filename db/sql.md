> 大多数面试都是以mysql为例，所以以下所有关于数据库相关的面试题都是基于mysql的（当然其他数据的原理也是大致相通的）

### 一条sql的执行过程
借用一张图  [一条SQL查询语句的执行过程](https://www.jianshu.com/p/d7ed81be71c7)：

![输入图片说明](https://images.gitee.com/uploads/images/2021/1029/093421_ff9b8651_8076629.png "屏幕截图.png")

一条sql语句从发送到数据库到它执行完成并返回结果，主要经历以下几个过程：

 **连接器->查询缓存(如果开启了查询缓存，则会经过这一步，但是大多数情况下都是不开启的，也不建议开启，MySQL 8.0之后也删除了这一块功能)->分析器->优化器->执行器** 

##### 1. 连接器

首先我们要跟数据库建立连接，这个过程就是连接器来完成的，它主要负责与客户端的通信，验证用户名和密码是否正确等。大多数的应用系统会在第一次启动的时候建立好一定数量的数据库连接池，这个就是通过连接器与数据库提前建立好连接

##### 2. 查询缓存
开启了查询缓存，那么在select查询语句过来的时候会先到查询缓存看看之前是不是执行过这条语句，查询缓存存储的数据是以键值对的形式进行存储（类似与map），key就是查询的sql语句，value是查询的结果。由于查询缓存这一块不是那么重要而且MySQL 8.0之后也删除了，这里就不再过多研究。面试的时候也只需要提一句即可。

##### 3. 分析器
对客户端传来的 sql 进行分析，包括预处理与解析过程，并进行关键词的提取、解析，并组成一个解析树，主要提取如 select/update/delete/or/in/where/group by/having/count/limit等这样的关键词

```
select *  from user where id = 1

```
例如这样的一条语句，在分析器中就通过语义规则器将select from where这些关键词提取和匹配出来，将用户的匹配字段和自定义语句识别出来，这个阶段也会做一些校验，比如校验user表是否存在，表中是否有id字段等

##### 4. 优化器

经过前面的步骤，数据库已经知道SQL可以执行了，接下来优化器会根据执行计划选择最优的选择，匹配合适的索引，选择最佳的方案。

 



### sql优化或你做过哪些方面的优化


[一条 sql 的执行过程详解](https://www.cnblogs.com/mengxinJ/p/14045520.html)

[一条SQL查询语句的执行过程](https://www.jianshu.com/p/d7ed81be71c7)
### 计算机网络七层体系结构（OSI七层结构）、TCP/IP四层模型、网络五层体系结构

 **七层体系结构（OSI七层结构）** ：为了使全世界不同体系结构的计算机能够互联，国际化标准组织ISO提出开放系统互联基本参考模型，简称OSI，即所谓的7层协议体系结构。

 **TCP/IP四层模型** ：是由实际应用发展总结出来的，它包含了应用层、传输层、网际层和网络接口层

 **五层体系结构** ：五层模型只出现在计算机网络学习教学过程中，他是对七层模型和四层模型的一个折中，及综合了OSI和TCP/IP 体系结构的优点，这样既简洁又能将概念阐述清楚，（主要是因为官方的7层模型太过麻烦复杂）因此主要差别是去掉了会话层和表示层，而传输层改为了运输层，因为他们觉得运输名字更贴切。
 
 ![输入图片说明](network.png)
 
### Http在哪一层？tcp/udp在哪一层？ip在哪一层？你还能说出哪些协议？

以下图片来自[javaguide之OSI 和 TCP/IP 网络分层模型详解（基础）](https://javaguide.cn/cs-basics/network/osi&tcp-ip-model.html)，可以直观的看到每一层对应的协议。

![输入图片说明](image.png) 

|     | 对应协议                     |
|-----|--------------------------|
| 应用层 | http 超文本传输协议 <br> smtp 电子邮件协议 <br> ftp 文件传输协议 <br> telnet 远程登陆协议<br> dns域名系统 |
| 运输层 | tcp ,udp                  |
| 网络层 | ip                       |


即http在应用层，tcp/udp在运输层（传输层），ip在网络层，各个层还有很多其他协议，有兴趣的可以研究一下，接下来主要针对Http，tcp/udp进行研究。

### TCP/UDP

TCP：传输控制协议 TCP（Transmission Control Protocol），TCP 提供面向连接的服务，在传送数据之前必须先建立连接，数据传送结束后要释放连接。

UDP：用户数据报协议 UDP（User Datagram Protocol），UDP 在传送数据之前不需要先建立连接，远程主机在收到 UDP 报文后，不需要给出任何确认。

##### 1. TCP 报文结构了解吗？

![输入图片说明](tcp.png)

其中固定首部通常为20个字节，这部分是我们需要了解的地方（其中标志位URG、ACK、PSH、RST、SYN、FIN为重点掌握）：

- 前4个字节来标识了发送方的端口号（即源端口，16位）和接收方的端口号（即目的端口，16位），即该数据包由谁发送，由谁接收。两个端口各占2个字节，2个字节共16位，最大可表示到65535（即2^16-1），其中0~1023是系统保留端口。

- 序号（Sequence Number），32位，在一个TCP连接中传送的字节流中的每一个字节都按顺序编号。整个要传送的字节流的起始序号必须在连接建立时设置。首部中的序号字段值则是指的是本报文段所发送的数据的第一个字节的序号。长度为4字节，范围在0~2^32-1， 超过则下一个序号会回到0重新增长。初始序号（ISN，即Initial Sequence Number）在建立连接时设置，ISN是一个随时间动态增长的非0序号，这也是为了防止被攻击者伪造初始序号和TCP报文，当SYN=1时，此为当前连接的初始序列号，数据的第一个字节序号为此ISN + 1，当SYN=0时，为当前连接报文段的累计数据包字节数。

- 确认号（Acknowledgment number），32位，发送确认的一端所期望收到的下一个序号，确认序号为上次接收的最后一个字节序号加1.只有确认标志位(ACK)为1的时候，确认序号才有效

- 数据偏移，也叫首部长度，4位，它指出 TCP 报文段的数据起始处距离 TCP 报文段的起始处有多远。这个字段实际上是指出TCP报文段的首部长度。

- 保留，6位，保留为今后使用，目前应置为 0。

-  **紧急URG（urgent）** ：当URG=1时，表明紧急指针字段有效，表明此报文段中有紧急数据，是高优先级的数据，应尽快发送，不用在缓存中排队。该控制位需配合紧急指针使用（紧急指针指出本报文段中紧急数据的字节数）。例如：我们需要取消一个已经发送了很长程序的运行，因此用户从键盘发出中断命令。如果不使用紧急数据，那么这个指令将存储在接收 TCP 的缓存末尾，只有在所有的数据被处理完毕后这两个字符才被交付接收方的应用进程，这样做就无法实现立即中断。

-  **确认ACK（acknowledgment）** ：仅当 ACK = 1 时确认号（即上面的Acknowledgment number）字段才有效，当 ACK = 0 时确认号无效。TCP 规定，在连接建立后所有传送的报文段都必须把 ACK 置为 1。

-  **推送PSH（push）** ：当两个应用进程进行交互式的通信时，有时在一端的应用进程希望在键入一个命令后立即就能收到对方的响应。在这种情况下，TCP 就可以使用推送（push）操作。这时，发送方 TCP 把 PSH 置为 1，并立即创建一个报文段发送出去。接收方 TCP 收到 PSH = 1 的报文段，就尽快地交付接收应用进程。而不用等到整个缓存都填满了后再向上交付。

-  **复位RST（reset）** ：当 RST = 1 时，表明 TCP 连接中出现了严重错误（如由于主机崩溃或其他原因），必须释放连接，然后再重新建立传输连接。

-  **同步SYN（synchronization）** ：SYN = 1 表示这是一个连接请求或连接接受报文。当 SYN = 1 而 ACK = 0 时，表明这是一个连接请求报文段。对方若同意建立连接，则应在响应的报文段中使 SYN = 1 且 ACK = 1 。

-  **终止FIN（finish）** ：用来释放一个连接。当 FIN = 1时，表明此报文段的发送发的数据已发送完毕，并要求释放连接。

- 窗口，16位，窗口指的是发送本报文段的一方的接受窗口（而不是自己的发送窗口）,窗口大小是给对方用的。窗口值告诉对方：从本报文段首部中的确认号算起，接收方目前允许对方一次发送的数据量（以字节为单位），之所以要有这个限制，是因为接收方的数据缓存空间是有限的。例如：A发送了一个报文段，其确认号是3000，窗口字段是1000.这就是告诉对方B：“从3000算起，A接收缓存空间还可接受1000个字节数据，字节序号是3000-3999”

- 检验和，16位，检验和字段检验的范围包括首部和数据这两部分。和UDP用户数据报一样，在计算检验和时，要在TCP报文段的前面加上12字节的伪首部。伪首部的格式和UDP用户数据报的伪首部一样。但应把伪首部第4个字段中的17改为6（TCP的协议号是6）；把第5字段中的UDP中的长度改为TCP长度。接收方收到此报文段后，仍要加上这个伪首部来计算检验和

- 紧急指针，16位，紧急指针仅在URG=1时才有意义，它指出本报文段中的紧急数据的字节数（紧急数据结束后就是普通数据） 。因此，在紧急指针指出了紧急数据的末尾在报文段中的位置。当所有紧急数据都处理完时，TCP就告诉应用程序恢复到正常操作。值得注意的是，即使窗口为0时也可以发送紧急数据。

- 选项，长度可变，最长可达40个字节。当没有使用“选项”时，TCP的首部长度是20字节。选项可设置为：

![输入图片说明](tcpselect.png)

其中，窗口缩放选项（又称窗口扩大选项），TCP首部中窗口字段长度是16位，因此最大的窗口大小为64K字节。虽然这对早期的网络是足够用的，但对于包含卫星信道的网络，传播时延和宽带都很大，要获得高吞吐量需要更大的窗口大小，窗口扩大选项占3字节，其中有一个字节表示移位值S。新的窗口值等于TCP首部中的窗口位数从16增大到（16+S）。移位值允许使用的最大值是14，相当于窗口最大值增大到 2^30 - 1个字节。

最大段大小选项（最大报文段长度选项），表示TCP传往另一端的最大块数据的长度。当一个连接建立时，连接的双方都要通告各自的MSS。

时间戳选项，时间戳选项占10字节，其中最主要的字段是时间戳字段（4字节）和时间戳回送回答字段（4字节）。时间戳选项有以下两个概念：1.用来计算往返时间RTT。发送方在发送报文段时把当前时钟的时间值放入时间戳字段，接收方在确认该报文段时把时间戳字段复制到时间戳回送回答字段。因此，发送方在收到确认报文后，可以准确地计算出RTT来。2.用于处理TCP序号超过2^32 的情况，这又称为防止序号绕回PAWS。我们知道，TCP报文段的序号只有32位，而每增加2^32 个序号就会重复使用原来用过的序号。当使用高速网络时，在一次TCP连接的数据传送中序号很可能被重复使用。例如，当使用1.5Mbit/s的速度发送报文段时，序号重复要6小时以上。但若用2.5Gbit/s的速率发送报文段，则不到14秒钟序号就会重复。为了使接收方能够把新的报文段和迟到很久的报文段区分开，则可以在报文段中加上这种时间戳。

##### 2. TCP 的三次握手和四次挥手描述一下？

##### 3. SYN攻击是什么？

##### 4. UDP传输过程描述？为什么是不可靠的？

### http
- http介绍
- http格式描述？
- get，post区别
- https是什么？


参考：

https://zhuanlan.zhihu.com/p/163691647

https://blog.csdn.net/liuchengzimozigreat/article/details/100169829

https://segmentfault.com/a/1190000039165592

https://www.jianshu.com/p/7b83a0070588
